<?php
require_once('./../../../vendor/mevdschee/php-crud-api/api.include.php');
use Tqdev\PhpCrudApi\Api;
use Tqdev\PhpCrudApi\Config;
use Tqdev\PhpCrudApi\RequestFactory;
use Tqdev\PhpCrudApi\ResponseUtils;
//

$path="./../../../vendor/mevdschee/php-crud-api";
$sqlFile=$path."/tests/fixtures/blog_sqlite.sql";
$dbName='test.db';
if (!file_exists($dbName)) {
    $pdo =new PDO("sqlite:$dbName");
    $c=file_get_contents($sqlFile);
    $pdo->exec($c);
}
//
$config = new Config([
    'driver' => 'sqlite',
    'address' => $dbName,
    'username' => '',
    'password' => '',
    'database' => $dbName/*,
    'middlewares' => 'basicAuth',
    'basicAuth.mode' => 'required'*/
]);
$request = RequestFactory::fromGlobals();
$api = new Api($config);
$response = $api->handle($request);
ResponseUtils::output($response);
