import pcajs from "../../../esm/index.js";
const pca=pcajs('./../../server/api.php');

const getBlob=(file,callback) => {
    const r=f=>typeof f==='function'?f():f
    const b =(h,d,e=false)=> ({
        header: h,
        body: d,
        error:e,
        file:file,
        all: function () {
            return this.header + this.body
        }
    });
    const reader = new FileReader();
    reader.onload=()=> {
        const rr = reader.result, index = rr.indexOf(',');
        if (index===-1) callback('',rr);
        else callback(b(rr.slice(0, index + 1),rr.slice(index + 1)));
    }
    reader.onerror=()=>callback('','',true)
    reader.readAsDataURL(r(file));
};

const up=()=>{
    getBlob(
        document.querySelector('input[type=file]').files[0],
        ({body})=>console.log(body)
    )
}


document.querySelector('input[type=file]').addEventListener(
  'change', up
);

