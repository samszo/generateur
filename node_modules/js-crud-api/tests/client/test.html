<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <script>
        const castArray=(a)=>Array.isArray(a)?a:[a];
        const prefix=p=>s=>p+s;
        const a_join=d=>a=>a.join(d);
        const mapN=a=>(...f)=>f.reduce((acc,v)=>acc.map(v),a);
        const str_join=s=>a_join('&')(
            mapN(castArray(s))(castArray,a_join(','),prefix('join='))
        );
        let a =[1,2,[3,4]];
        console.log(str_join(a));
        
        /*
                const castArray=(a)=>Array.isArray(a)?a:[a];
        const prefix=p=>s=>p+s;
        const join=d=>a=>a.join(d);
        const mapN=a=>(...f)=>f.reduce((acc,v)=>acc.map(v),a);
        const str_join=s=>join('&')(
            mapN(castArray(s))(castArray,join,prefix('join='))
        );
        
        let a=[1,2,[3,4]];
        console.log(str_join(a));
         */
        const joinWithArray_old=s=>castArray(s)
            .reduce(
                (acc,v)=>{
                    if (Array.isArray(v)){
                        acc[0]=v; // only the last array taken into account
                    } else {
                        acc[1].push(""+v); // forced to string, whatever order
                    }
                    return acc;
                },[[],[]])
            .reduce((acc,v,i)=> {
                console.log(i,v);
                acc.push(i===0
                    ? 'join='+v.join(',')
                    : v.map(v=>'join='+v).join('&')
                );
                return acc;
            },[]).join('&');
    </script>
</body>
</html>